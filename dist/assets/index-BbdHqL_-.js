(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();const f="https://api.themoviedb.org/3/",m="54c742d2b8e33089658b656855ac48ab";async function l(e){const t=e.includes("?")?"&":"?",r=await fetch(f+e+t+`api_key=${m}`);if(!r.ok)throw new Error(`Fetch failed: ${r.status} ${r.statusText}`);return await r.json()}async function p(e=1){return(await l(`discover/movie?language=en-US&sort_by=popularity.desc&page=${e}`)).results}async function y(e,t=1){return(await l(`discover/movie?language=en-US&sort_by=popularity.desc&page=${t}&with_genres=${e}`)).results}async function g(e=1){return(await l(`discover/tv?language=en-US&sort_by=popularity.desc&page=${e}`)).results}async function v(e,t=1){return(await l(`discover/tv?language=en-US&sort_by=popularity.desc&page=${t}&with_genres=${e}`)).results}const h={movie:{action:28,adventure:12,animation:16,comedy:35,crime:80,documentary:99,drama:18,family:10751,fantasy:14,history:36,horror:27,music:10402,mystery:9648,romance:10749,scifi:878,thriller:53,war:10752,western:37,biography:36,musical:10402},tv:{action:10759,animation:16,comedy:35,crime:80,documentary:99,drama:18,family:10751,kids:10762,mystery:9648,news:10763,reality:10764,scifi:10765,talk:10767,war:10768}};function w(e,t,r="|"){if(!e||!t)return"";const n=h[t]||{};return(Array.isArray(e)?e:[e]).map(a=>n[a.toLowerCase().replace(/\s+/g,"")]).filter(Boolean).join(r)}function b(e,t="w500"){return e?`https://image.tmdb.org/t/p/${t}${e}`:""}const i=e=>document.getElementById(e),d=e=>e==null?"":String(e);function $(e,t){const r=d(t==="tv"?e.name:e.title),n=b(e.poster_path)||"",o=typeof e.vote_average=="number"?e.vote_average.toFixed(1):"—";return`
    <article class="card">
      ${n?`<img class="movie-poster" loading="lazy" src="${n}" alt="${r} poster">`:""}
      <div class="card-body">
        <h3 class="movie-title">${r}</h3>
        <p class="meta">⭐ ${o}</p>
      </div>
    </article>
  `}function c(e,t){const r=i("results");if(!r){console.error("Missing #results element in HTML.");return}r.innerHTML=e.map(n=>$(n,t)).join("")}async function u(e){if(e==="tv"){const t=await g();c(t,"tv")}else{const t=await p();c(t,"movie")}}async function L(e,t){const r=w(t,e,"|");if(!r)return u(e);if(e==="tv"){const n=await v(r);c(n,"tv")}else{const n=await y(r);c(n,"movie")}}document.addEventListener("DOMContentLoaded",()=>{const e=i("finder-form"),t=i("genre-select"),r=i("content-type-select");if(!e||!t||!r){console.error("Missing one of: #finder-form, #genre-select, #content-type-select");return}u(r.value||"movie").catch(console.error),e.addEventListener("submit",n=>{n.preventDefault(),L(r.value||"movie",t.value||"").catch(o=>{console.error(o);const s=i("results");s&&(s.textContent="Failed to load results.")})}),r.addEventListener("change",()=>{u(r.value||"movie").catch(console.error)})});
